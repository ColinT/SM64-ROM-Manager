<?xml version="1.0" encoding="utf-8"?>
<m64tweak name="More Objects Patch" description="" version="1.0.0.0">
  <patch name="Apply MOP1, 2 and 3" description="" type="1" references="">Imports Microsoft.VisualBasic
Imports System
Imports System.Collections.Generic
Imports System.IO
Imports System.Linq
Imports System.Windows.Forms
Imports SM64Lib

Module Script

    Sub Main(params as IReadOnlyDictionary(Of String, Object))
        Dim tweakDir as String = Path.GetDirectoryName(params("profilepath"))
        Dim patchFile as String = Path.Combine(tweakDir, "mop123rm.ppf")
        PatchClass.ApplyPPF(params("romfile"), patchFile)
    End Sub

End Module
</patch>
  <patch name="Open MOP Patcher" description="" type="1" references="">Imports Microsoft.VisualBasic
Imports System
Imports System.Collections.Generic
Imports System.Diagnostics
Imports System.IO
Imports System.Linq
Imports System.Windows.Forms
Imports SM64Lib

Module Script

    Sub Main(params as IReadOnlyDictionary(Of String, Object))
        Dim tweakDir as String = Path.GetDirectoryName(params("profilepath"))
        Dim patchFile as String = Path.Combine(tweakDir, "MOPPatcher.exe")
        
        dim p as new Process
        p.StartInfo.Arguments       = """" &amp; params("romfile") &amp; """"
        p.StartInfo.FileName        = patchFile
        p.StartInfo.UseShellExecute = False
        p.Start
        p.WaitForExit
    End Sub

End Module
</patch>
</m64tweak>